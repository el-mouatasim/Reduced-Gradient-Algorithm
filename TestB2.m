%Test 
clear all;
format long
%format short
a=[0.795137  0.225733  0.371307  0.225064  0.878756;
  -0.905037 -0.638848 -0.134430 -0.921211  0.150370;
   0.905037  0.248231  0.278197  0.376265 -0.597468;
   0.762043 -0.304755 -0.012345 -0.394012 -0.792129;%-0.394312
   0.564347  0.746523 -0.822105 -0.892331 -0.922916;
  -0.954276 -0.196016  0.242000  0.797813 -0.147119;
   0.747682  0.912055 -0.529338  0.243496  0.279402;
  -0.109599  0.727219 -0.741781 -0.058455  0.749470;
   0.209106 -0.074202 -0.022484 -0.144214 -0.735169];
A=[a,eye(9,9)];
b=[4.242372;-1.785220;3.213560;1.205676;-0.891062;-0.066698;2.286079;...
    0.521564;-0.730516];
%
%xi=[0.925184,0,0.099742,1.18124,1.022055];
xi=[2.928723, 0.000000, 0.857287, 0.249422, 1.751548];
%xi=[1.912493, 0.000000, 0.489386, 0.228797, 1.477797];
xa = b-a*xi';
X0=[xi,xa'];
%
imax=30;
ksto= 5000;
[n]=length(X0)
[n_c]=length(b)
t = cputime;
  %  [FX,X,i]=SPRGB_v2a(@FB2,@gradFB2,A,b,X0,imax,ksto)
% e = cputime-t
% FX =
% -21.121975301626829
%X =
%Columns 1 through 5
%0.409645133870620   5.601110808864414   6.135397388264606   0.000001567299221   0.425802043098572
%Columns 6 through 10
% 0   2.924537502541236   0.000000017925044   3.013507562695761   0.133319740106945
% Columns 11 through 14
%0.000000008486778   0.000002246870807   0.725221940155212   0.050423332003173
%i =
% 30
%e =
%30.093750000000000
    [FX,X,i]=RGB(@FB2,@gradFB2,A,b,X0)
    %%FX=-21.1219
    %lb = zeros(size(X0));
    %[x,fval,exitflag,output] = fmincon(@FB2,X0,[],[],A,b,lb,[])
    %fval=-21.1219; it=6 
%lb=zeros(size(X0));
%e=-21.1219; 
%[X,fval,i]=frank_wolfe_v1(@FB2,@gradFB2,X0,e,[],[],A,b,lb,[])
%fval = -21.1219